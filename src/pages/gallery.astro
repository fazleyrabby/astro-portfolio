---
Astro.response.headers.set("Cache-Control", "max-age=604800");
import { Image } from "@unpic/astro";
import MainLayout from "@layouts/MainLayout.astro";
import { v2 as cloudinary } from "cloudinary";
import ImagePopup from "@components/ImagePopup.astro";
const env = import.meta.env;

cloudinary.config({
    cloud_name: env.CLOUDINARY_CLOUD_NAME,
    api_key: env.CLOUDINARY_API_KEY,
    api_secret: env.CLOUDINARY_API_SECRET,
    secure: true,
});

const images = await cloudinary.search
    .expression("folder:photography*")
    .sort_by("uploaded_at", "desc")
    .max_results(15)
    .execute();
---

<MainLayout title="Photography">
    <main>
        <p
            class="text-lg text-center my-6 bg-gradient-to-r from-gray-600 to-gray-500 dark:from-gray-300 dark:to-gray-400 bg-clip-text text-transparent font-medium"
        >
            Some random shots I have taken on various trips. Mostly using my
            smart phone!
        </p>

        <!-- Simple Grid Layout -->
        <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
            {
                images.total_count > 0 &&
                    images.resources.map((img) => (
                        <div class="group relative overflow-hidden bg-gray-100 dark:bg-gray-800 aspect-square">
                            <Image
                                height={400}
                                width={400}
                                loading="lazy"
                                layout="fullWidth"
                                class="w-full h-full object-cover lightbox-image cursor-pointer group-hover:scale-105 transition-transform duration-300"
                                data-img={img.secure_url}
                                src={img.secure_url}
                                alt="Photography"
                            />
                        </div>
                    ))
            }
        </div>

        <ImagePopup />
        <p class="text-gray-400 dark:text-gray-500 my-6 text-xs text-center">
            (These images are hosted on Cloudinary)
        </p>
    </main>
</MainLayout>
